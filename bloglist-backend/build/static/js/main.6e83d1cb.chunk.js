(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{58:function(e,t,n){e.exports=n(88)},87:function(e,t,n){},88:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(17),c=n.n(l),u=n(6),o=n.n(u),i=n(9),s=n(19),m=n(90),d=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),l=Object(s.a)(n,2),c=l[0],u=l[1],o={display:c?"none":""},i={display:c?"":"none"},d=function(){u(!c)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:d}})),r.a.createElement("div",null,r.a.createElement("div",{style:o},r.a.createElement(m.a,{onClick:d,id:"toggalbeShowButton"},e.buttonLabel)),r.a.createElement("div",{style:i},e.children,r.a.createElement(m.a,{onClick:d,id:"toggalbeCancelButton"},"cancel")))}));d.displayName="Togglable";var f=d,E=n(15),p=n.n(E),g="/api/blogs",v=null,b=function(){var e=Object(i.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:v}},console.log("token: ",v),e.next=4,p.a.post(g,t,n);case 4:return a=e.sent,e.abrupt("return",a.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(i.a)(o.a.mark((function e(t,n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={comment:t},e.next=3,p.a.post("".concat(g,"/").concat(n,"/comments"),a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),O={getAll:function(){return p.a.get(g).then((function(e){return e.data}))},create:b,setToken:function(e){v="bearer ".concat(e)},remove:function(e){var t={headers:{Authorization:v}};return p.a.delete("".concat(g,"/").concat(e),t).then((function(e){return e.data}))},update:function(){var e=Object(i.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.put("".concat(g,"/").concat(n),t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),addComment:h},w={login:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},y=n(5),j=n(57),S=n(56),k=function(){return function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"NEW_BLOG":return[].concat(Object(S.a)(e),[t.data]);case"UPDATE_BLOG":var n=t.data.id,a=e.find((function(e){return e.id===n})),r=Object(j.a)({},a,{likes:a.likes+1});return e.map((function(e){return e.id!==n?e:r}));case"DELETE_BLOG":return t.data;default:return e}},x={username:"",password:""},B=function(e,t){return{type:"SET_CREDENTIALS",data:{username:e,password:t}}},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CREDENTIALS":return t.data;default:return e}},L=function(e){return{type:"SET_USER",user:e}},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.user;default:return e}},_=n(92),N=function(e){var t=e.createBlog,n=Object(a.useState)(""),l=Object(s.a)(n,2),c=l[0],u=l[1],o=Object(a.useState)(""),i=Object(s.a)(o,2),d=i[0],f=i[1],E=Object(a.useState)(""),p=Object(s.a)(E,2),g=p[0],v=p[1];return r.a.createElement("div",null,r.a.createElement("h2",null,"Create a new blog"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t({title:c,author:d,url:g}),u(""),f(""),v("")}},r.a.createElement(_.a.Group,null,r.a.createElement(_.a.Label,null,"title:"),r.a.createElement(_.a.Control,{id:"title",type:"text",value:c,name:"Title",onChange:function(e){var t=e.target;return u(t.value)}}),r.a.createElement(_.a.Label,null,"author:"),r.a.createElement(_.a.Control,{id:"author",type:"text",value:d,name:"Author",onChange:function(e){var t=e.target;return f(t.value)}}),r.a.createElement(_.a.Label,null,"url:"),r.a.createElement(_.a.Control,{id:"url",type:"text",value:g,name:"Password",onChange:function(e){var t=e.target;return v(t.value)}}),r.a.createElement(m.a,{variant:"primary",type:"submit",id:"submitNewBlog"},"submit"))))},A=function(e){return{type:"SET_MESSAGE",message:e}},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MESSAGE":case"REMOVE_MESAGE":return t.message;default:return e}},R=function(e){var t=e.handleLogin,n=e.username,a=e.password,l=Object(y.b)();return r.a.createElement("form",{onSubmit:t},r.a.createElement(_.a.Group,null,r.a.createElement(_.a.Label,null,"username:"),r.a.createElement(_.a.Control,{id:"username-form",type:"text",value:n,name:"Username",onChange:function(e){var t=e.target;return l(B(t.value,a))}}),r.a.createElement(_.a.Label,null,"password:"),r.a.createElement(_.a.Control,{id:"password-form",type:"password",value:a,name:"Password",onChange:function(e){var t=e.target;return l(B(n,t.value))}}),r.a.createElement(m.a,{variant:"primary",type:"submit",id:"loginButton"},"login")))},M=n(91),U=n(14),D=function(){var e=Object(y.b)();Object(a.useEffect)((function(){e(k())}),[e]);var t=Object(y.c)((function(e){return e.blogs})),n=Object(y.c)((function(e){return e.credentials})),l=Object(y.c)((function(e){return e.user}));Object(a.useEffect)((function(){var t=window.localStorage.getItem("loggedBlogappUser");if(t){var n=JSON.parse(t);e(L(n)),O.setToken(n.token)}}),[e]);var c=function(){var t=Object(i.a)(o.a.mark((function t(a){var r,l,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,r=n.username,l=n.password,t.next=6,w.login({username:r,password:l});case 6:c=t.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(c)),O.setToken(c.token),console.log("user: ",c),console.log("token :",c.token),e(L(c)),e(B("","")),e(A("Logged in successfuly")),setTimeout((function(){e({type:"REMOVE_MESAGE",message:null})}),5e3),t.next=22;break;case 17:t.prev=17,t.t0=t.catch(1),console.log("wrong credentials"),e(A("Wrong credentials")),setTimeout((function(){e({type:"REMOVE_MESAGE",message:null})}),5e3);case 22:case"end":return t.stop()}}),t,null,[[1,17]])})));return function(e){return t.apply(this,arguments)}}(),u=function(t){var n;e((n=t,function(){var e=Object(i.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.create(n);case 2:a=e.sent,t({type:"NEW_BLOG",data:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),e(A("Successfuly created a new blog")),setTimeout((function(){e({type:"REMOVE_MESAGE",message:null})}),5e3)},s=Object(a.useRef)(),m=t.sort((function(e,t){return e.likes>t.likes?-1:1}));return r.a.createElement("div",null,null===l?r.a.createElement(R,{handleLogin:c,username:n.username,password:n.password}):r.a.createElement("div",null,r.a.createElement("h2",null,"Blogs"),r.a.createElement(f,{buttonLabel:"new blog",ref:s},r.a.createElement(N,{createBlog:u})),r.a.createElement(M.a,{striped:!0},r.a.createElement("tbody",null,m.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement(U.b,{to:"/blogs/".concat(e.id)},e.title)),r.a.createElement("td",null,e.likes," likes"))}))))))},J=function(){return p.a.get("/api/users").then((function(e){return e.data}))},V=function(){return function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J();case 2:n=e.sent,t({type:"INIT_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":case"SET_USERS":return t.data;default:return e}},W=function(){var e=Object(y.b)(),t=Object(y.c)((function(e){return e.user})),n=Object(y.c)((function(e){return e.users}));return Object(a.useEffect)((function(){e(V())}),[e]),Object(a.useEffect)((function(){var t=window.localStorage.getItem("loggedBlogappUser");if(t){var n=JSON.parse(t);e(L(n)),O.setToken(n.token)}console.log("test")}),[e]),r.a.createElement("div",null,null===t?r.a.createElement("div",null,"pelase log in to see user information"):r.a.createElement("div",null,r.a.createElement("h2",null,"Users"),r.a.createElement(M.a,{striped:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"user name"),r.a.createElement("th",null,"blogs created"))),r.a.createElement("tbody",null,n.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement(U.b,{to:"/users/".concat(e.id)},e.name)),r.a.createElement("td",null,e.blogs.length))}))))))},z=function(){var e=Object(y.c)((function(e){return e.message}));return null===e?null:r.a.createElement("div",{className:"error"},e)},H=n(7),q=function(){var e=Object(y.b)(),t=Object(y.c)((function(e){return e.user})),n=Object(y.c)((function(e){return e.users}));Object(a.useEffect)((function(){e(V())}),[e]),Object(a.useEffect)((function(){var t=window.localStorage.getItem("loggedBlogappUser");if(t){var n=JSON.parse(t);e(L(n)),O.setToken(n.token)}}),[e]);var l=Object(H.f)().id,c=n.find((function(e){return String(e.id)===String(l)}));return r.a.createElement("div",null,null===t?r.a.createElement("div",null,"pelase log in to see user information"):r.a.createElement("div",null,c?r.a.createElement("div",null,r.a.createElement("h2",null,c.name),r.a.createElement("h3",null,"added blogs"),r.a.createElement("ul",null,c.blogs.map((function(e){return r.a.createElement("li",{key:e.id},e.title)})))):r.a.createElement("h3",null,"No user with such id exists int he database")))},F=function(){var e=Object(a.useState)(""),t=Object(s.a)(e,2),n=t[0],l=t[1],c=Object(y.b)();Object(a.useEffect)((function(){c(k())}),[c]);var u=Object(y.c)((function(e){return e.blogs})),d=Object(H.f)().id,f=u.find((function(e){return String(e.id)===String(d)})),E=Object(y.c)((function(e){return e.user}));Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);c(L(t)),O.setToken(t.token)}}),[c]);return r.a.createElement("div",null,null===E?r.a.createElement("div",null,"pelase log in to see user information"):r.a.createElement("div",null,f?r.a.createElement("div",null,r.a.createElement("h1",{id:"singleBlogTitle"},f.title),r.a.createElement(M.a,null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"url: ",r.a.createElement("a",{href:f.url},f.url))),r.a.createElement("tr",null,r.a.createElement("td",null," ",f.likes," likes ",r.a.createElement(m.a,{onClick:function(){var e={user:f.user.id,likes:f.likes+1,author:f.author,title:f.title,url:f.url};console.log("blog object: ",e),c(function(e,t){return function(){var n=Object(i.a)(o.a.mark((function n(a){var r;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,O.update(e,t);case 2:r=n.sent,a({type:"UPDATE_BLOG",data:r});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(e,f.id))}},"like"),r.a.createElement("br",null))),r.a.createElement("tr",null,r.a.createElement("td",null,"added by ",f.author)))),r.a.createElement("form",{onSubmit:function(){O.addComment(n,f.id),c(k())}},r.a.createElement(_.a.Group,null,r.a.createElement("h4",null,"comment"),r.a.createElement(_.a.Control,{id:"title",type:"text",value:n,name:"Title",onChange:function(e){var t=e.target;return l(t.value)}}),r.a.createElement(m.a,{variant:"primary",type:"submit",id:"addCommentButton"},"Add comment"))),r.a.createElement("h3",null,"comments:"),r.a.createElement("ul",null,f.comments.map((function(e,t){return r.a.createElement("li",{key:t},e)}))),f.user&&E&&(f.user.id===E.id||f.user===E.id)?r.a.createElement(m.a,{onClick:function(){window.confirm("Delete the blog ".concat(f.title,"?"))&&(c(function(e){return function(){var t=Object(i.a)(o.a.mark((function t(n){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.remove(e);case 2:return t.next=4,O.getAll();case 4:a=t.sent,n({type:"DELETE_BLOG",data:a});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(f.id)),c(A("Successfuly removed the blog")),setTimeout((function(){c({type:"REMOVE_MESAGE",message:null})}),5e3))},style:{background:"red"}},"delete"):null):r.a.createElement("h3",null,"No post with such id exists int he database")))},K=n(93),Q=n(94),X=function(){var e=Object(y.b)(),t=Object(y.c)((function(e){return e.user}));return r.a.createElement("div",{className:"menuItem",id:"loggedInText"},t.name," logged-in ",r.a.createElement(m.a,{variant:"outline-primary",size:"sm",onClick:function(){window.localStorage.clear(),e(L(null)),e(A("Logged out successfuly")),setTimeout((function(){e({type:"REMOVE_MESAGE",message:null})}),5e3)},id:"logOutButton"},"log out"))},Y=function(){var e=Object(y.b)(),t=Object(y.c)((function(e){return e.user}));Object(a.useEffect)((function(){var t=window.localStorage.getItem("loggedBlogappUser");if(t){var n=JSON.parse(t);e(L(n)),O.setToken(n.token)}}),[e]);var n={padding:5};return r.a.createElement(U.a,null,r.a.createElement("div",{className:"container"},r.a.createElement(K.a,{collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark"},r.a.createElement(K.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),r.a.createElement(K.a.Collapse,{id:"responsive-navbar-nav"},r.a.createElement(Q.a,{className:"mr-auto"},r.a.createElement(Q.a.Link,{href:"#",as:"span"},r.a.createElement(U.b,{style:n,to:"/"},"home")),r.a.createElement(Q.a.Link,{href:"#",as:"span"},r.a.createElement(U.b,{style:n,to:"/users"},"users")),r.a.createElement(Q.a.Item,{id:"loggedInIndicator"},null===t?null:r.a.createElement(X,null))))),r.a.createElement(z,null),r.a.createElement(H.c,null,r.a.createElement(H.a,{path:"/users/:id"},r.a.createElement(q,null)),r.a.createElement(H.a,{path:"/users"},r.a.createElement(W,null)),r.a.createElement(H.a,{path:"/blogs/:id"},r.a.createElement(F,null)),r.a.createElement(H.a,{path:"/"},r.a.createElement(D,null)))))},Z=(n(87),n(22)),$=n(54),ee=n(55),te=Object(Z.combineReducers)({blogs:T,credentials:C,user:I,message:G,users:P}),ne=Object(Z.createStore)(te,Object(ee.composeWithDevTools)(Object(Z.applyMiddleware)($.a)));c.a.render(r.a.createElement(y.a,{store:ne},r.a.createElement(Y,null)),document.getElementById("root"))}},[[58,1,2]]]);
//# sourceMappingURL=main.6e83d1cb.chunk.js.map