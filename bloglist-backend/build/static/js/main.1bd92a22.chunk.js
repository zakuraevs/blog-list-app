(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{58:function(e,t,n){e.exports=n(88)},87:function(e,t,n){},88:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(18),c=n.n(l),u=n(6),o=n.n(u),i=n(9),s=n(16),m=n(90),d=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),l=Object(s.a)(n,2),c=l[0],u=l[1],o={display:c?"none":""},i={display:c?"":"none"},d=function(){u(!c)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:d}})),r.a.createElement("div",null,r.a.createElement("div",{style:o},r.a.createElement(m.a,{onClick:d,id:"toggalbeShowButton"},e.buttonLabel)),r.a.createElement("div",{style:i},e.children,r.a.createElement(m.a,{onClick:d,id:"toggalbeCancelButton"},"cancel")))}));d.displayName="Togglable";var f=d,E=n(15),p=n.n(E),g="/api/blogs",b=null,v=function(){var e=Object(i.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:b}},e.next=3,p.a.post(g,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(i.a)(o.a.mark((function e(t,n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={comment:t},e.next=3,p.a.post("".concat(g,"/").concat(n,"/comments"),a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),O={getAll:function(){return p.a.get(g).then((function(e){return e.data}))},create:v,setToken:function(e){b="bearer ".concat(e)},remove:function(e){var t={headers:{Authorization:b}};return p.a.delete("".concat(g,"/").concat(e),t).then((function(e){return e.data}))},update:function(){var e=Object(i.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.put("".concat(g,"/").concat(n),t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),addComment:h},y={login:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},w=n(5),j=n(57),S=n(56),k=function(){return function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},T=function(e,t){return function(){var n=Object(i.a)(o.a.mark((function n(a){var r;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,O.update(e,t);case 2:r=n.sent,a({type:"UPDATE_BLOG",data:r});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"NEW_BLOG":return[].concat(Object(S.a)(e),[t.data]);case"UPDATE_BLOG":var n=t.data.id,a=e.find((function(e){return e.id===n})),r=Object(j.a)({},a,{likes:a.likes+1});return e.map((function(e){return e.id!==n?e:r}));case"DELETE_BLOG":return t.data;default:return e}},L={username:"",password:""},B=function(e,t){return{type:"SET_CREDENTIALS",data:{username:e,password:t}}},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CREDENTIALS":return t.data;default:return e}},N=function(e){return{type:"SET_USER",user:e}},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.user;default:return e}},R=n(92),U=function(e){var t=e.createBlog,n=Object(a.useState)(""),l=Object(s.a)(n,2),c=l[0],u=l[1],o=Object(a.useState)(""),i=Object(s.a)(o,2),d=i[0],f=i[1],E=Object(a.useState)(""),p=Object(s.a)(E,2),g=p[0],b=p[1],v=Object(a.useState)(""),h=Object(s.a)(v,2),O=h[0],y=h[1],w=Object(a.useState)(""),j=Object(s.a)(w,2),S=j[0],k=j[1];return r.a.createElement("div",null,r.a.createElement("h2",null,"Create a new blog post"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t({title:c,author:d,url:g,imageURL:O}),u(""),f(""),b(""),y(""),k("")}},r.a.createElement(R.a.Group,null,r.a.createElement(R.a.Label,null,"title:"),r.a.createElement(R.a.Control,{id:"title",type:"text",value:c,name:"Title",onChange:function(e){var t=e.target;return u(t.value)}}),r.a.createElement(R.a.Label,null,"author:"),r.a.createElement(R.a.Control,{id:"author",type:"text",value:d,name:"Author",onChange:function(e){var t=e.target;return f(t.value)}}),r.a.createElement(R.a.Label,null,"Post text:"),r.a.createElement(R.a.Control,{id:"text",type:"text",value:S,name:"Password",onChange:function(e){var t=e.target;return k(t.value)}}),r.a.createElement(R.a.Label,null,"Post image URL:"),r.a.createElement(R.a.Control,{id:"imageURL",type:"text",value:O,name:"imageURL",onChange:function(e){var t=e.target;return y(t.value)}}),r.a.createElement(m.a,{variant:"primary",type:"submit",id:"submitNewBlog"},"submit"))))},_=function(e){return{type:"SET_MESSAGE",message:e}},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MESSAGE":case"REMOVE_MESAGE":return t.message;default:return e}},G=function(e){var t=e.handleLogin,n=e.username,a=e.password,l=Object(w.b)();return r.a.createElement("form",{onSubmit:t},r.a.createElement(R.a.Group,null,r.a.createElement(R.a.Label,null,"username:"),r.a.createElement(R.a.Control,{id:"username-form",type:"text",value:n,name:"Username",onChange:function(e){var t=e.target;return l(B(t.value,a))}}),r.a.createElement(R.a.Label,null,"password:"),r.a.createElement(R.a.Control,{id:"password-form",type:"password",value:a,name:"Password",onChange:function(e){var t=e.target;return l(B(n,t.value))}}),r.a.createElement(m.a,{variant:"primary",type:"submit",id:"loginButton"},"login")))},M=n(91),D=n(14),J=function(){var e=Object(w.b)();Object(a.useEffect)((function(){e(k())}),[e]);var t=Object(w.c)((function(e){return e.blogs})),n=Object(w.c)((function(e){return e.credentials})),l=Object(w.c)((function(e){return e.user}));Object(a.useEffect)((function(){var t=window.localStorage.getItem("loggedBlogappUser");if(t){var n=JSON.parse(t);e(N(n)),O.setToken(n.token)}}),[e]);var c=function(){var t=Object(i.a)(o.a.mark((function t(a){var r,l,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,r=n.username,l=n.password,t.next=6,y.login({username:r,password:l});case 6:c=t.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(c)),O.setToken(c.token),console.log("user: ",c),console.log("token :",c.token),e(N(c)),e(B("","")),e(_("Logged in successfuly")),setTimeout((function(){e({type:"REMOVE_MESAGE",message:null})}),5e3),t.next=22;break;case 17:t.prev=17,t.t0=t.catch(1),console.log("wrong credentials"),e(_("Wrong credentials")),setTimeout((function(){e({type:"REMOVE_MESAGE",message:null})}),5e3);case 22:case"end":return t.stop()}}),t,null,[[1,17]])})));return function(e){return t.apply(this,arguments)}}(),u=function(t){var n;e((n=t,function(){var e=Object(i.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.create(n);case 2:a=e.sent,t({type:"NEW_BLOG",data:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),e(_("Successfuly created a new blog")),setTimeout((function(){e({type:"REMOVE_MESAGE",message:null})}),5e3)},s=Object(a.useRef)(),d=t.sort((function(e,t){return e.likes>t.likes?-1:1}));return r.a.createElement("div",null,null===l?r.a.createElement(G,{handleLogin:c,username:n.username,password:n.password}):r.a.createElement("div",null,r.a.createElement("h2",{className:"homeHeader"},"Blog posts"),r.a.createElement(f,{buttonLabel:"new post",ref:s},r.a.createElement(U,{createBlog:u})),r.a.createElement(M.a,{striped:!0},r.a.createElement("tbody",null,d.map((function(t){return r.a.createElement("tr",{key:t.id},r.a.createElement("td",{className:"homeBlogTitles"},r.a.createElement("div",null,r.a.createElement(D.b,{className:"homeBlogTitles",to:"/blogs/".concat(t.id)},t.title),r.a.createElement("br",null),r.a.createElement("br",null),t.imageURL?r.a.createElement("img",{className:"homeBlogImage",src:t.imageURL}):null,r.a.createElement("br",null),t.likes+" likes "," ",t.comments.length," ",1===t.comments.length?" comment":"comments"," - posted by ",t.author,"- ",r.a.createElement(m.a,{onClick:function(){return function(t){var n={user:t.user.id,likes:t.likes+1,author:t.author,title:t.title,url:t.url};console.log("blog object: ",n),e(T(n,t.id))}(t)}},"like"))))}))))))},V=function(){return p.a.get("/api/users").then((function(e){return e.data}))},P=function(){return function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V();case 2:n=e.sent,t({type:"INIT_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":case"SET_USERS":return t.data;default:return e}},z=function(){var e=Object(w.b)(),t=Object(w.c)((function(e){return e.user})),n=Object(w.c)((function(e){return e.users}));return Object(a.useEffect)((function(){e(P())}),[e]),Object(a.useEffect)((function(){var t=window.localStorage.getItem("loggedBlogappUser");if(t){var n=JSON.parse(t);e(N(n)),O.setToken(n.token)}console.log("test")}),[e]),r.a.createElement("div",null,null===t?r.a.createElement("div",null,"pelase log in to see user information"):r.a.createElement("div",null,r.a.createElement("h2",null,"Users"),r.a.createElement(M.a,{striped:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"user name"),r.a.createElement("th",null,"blogs created"))),r.a.createElement("tbody",null,n.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement(D.b,{to:"/users/".concat(e.id)},e.name)),r.a.createElement("td",null,e.blogs.length))}))))))},H=function(){var e=Object(w.c)((function(e){return e.message}));return null===e?null:r.a.createElement("div",{className:"error"},e)},q=n(7),F=function(){var e=Object(w.b)(),t=Object(w.c)((function(e){return e.user})),n=Object(w.c)((function(e){return e.users}));Object(a.useEffect)((function(){e(P())}),[e]),Object(a.useEffect)((function(){var t=window.localStorage.getItem("loggedBlogappUser");if(t){var n=JSON.parse(t);e(N(n)),O.setToken(n.token)}}),[e]);var l=Object(q.f)().id,c=n.find((function(e){return String(e.id)===String(l)}));return r.a.createElement("div",null,null===t?r.a.createElement("div",null,"pelase log in to see user information"):r.a.createElement("div",null,c?r.a.createElement("div",null,r.a.createElement("h2",null,c.name),r.a.createElement("h3",null,"added blogs"),r.a.createElement("ul",null,c.blogs.map((function(e){return r.a.createElement("li",{key:e.id},e.title)})))):r.a.createElement("h3",null,"No user with such id exists int he database")))},K=function(){var e=Object(a.useState)(""),t=Object(s.a)(e,2),n=t[0],l=t[1],c=Object(w.b)();Object(a.useEffect)((function(){c(k())}),[c]);var u=Object(w.c)((function(e){return e.blogs})),d=Object(q.f)().id,f=u.find((function(e){return String(e.id)===String(d)})),E=Object(w.c)((function(e){return e.user}));Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);c(N(t)),O.setToken(t.token)}}),[c]);return r.a.createElement("div",null,null===E?r.a.createElement("div",null,"pelase log in to see user information"):r.a.createElement("div",null,f?r.a.createElement("div",null,r.a.createElement("h1",{id:"singleBlogTitle"},f.title),f.imageURL?r.a.createElement("img",{className:"singleBlogImage",src:f.imageURL}):null,r.a.createElement(M.a,null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"url: ",r.a.createElement("a",{href:f.url},f.url))),r.a.createElement("tr",null,r.a.createElement("td",null," ",f.likes," likes ",r.a.createElement(m.a,{onClick:function(){var e={user:f.user.id,likes:f.likes+1,author:f.author,title:f.title,url:f.url};console.log("blog object: ",e),c(T(e,f.id))}},"like"),r.a.createElement("br",null))),r.a.createElement("tr",null,r.a.createElement("td",null,"added by ",f.author)))),r.a.createElement("form",{onSubmit:function(){O.addComment(n,f.id)}},r.a.createElement(R.a.Group,null,r.a.createElement("h4",null,"comment"),r.a.createElement(R.a.Control,{id:"title",type:"text",value:n,name:"Title",onChange:function(e){var t=e.target;return l(t.value)}}),r.a.createElement(m.a,{variant:"primary",type:"submit",id:"addCommentButton"},"Add comment"))),r.a.createElement("h3",null,"comments:"),r.a.createElement("ul",null,f.comments.map((function(e,t){return r.a.createElement("li",{key:t},e)}))),f.user&&E&&(f.user.id===E.id||f.user===E.id)?r.a.createElement(m.a,{onClick:function(){window.confirm("Delete the blog ".concat(f.title,"?"))&&(c(function(e){return function(){var t=Object(i.a)(o.a.mark((function t(n){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.remove(e);case 2:return t.next=4,O.getAll();case 4:a=t.sent,n({type:"DELETE_BLOG",data:a});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(f.id)),c(_("Successfuly removed the blog")),setTimeout((function(){c({type:"REMOVE_MESAGE",message:null})}),5e3))},style:{background:"red"}},"delete"):null):r.a.createElement("h3",null,"No post with such id exists int he database")))},Q=n(93),X=n(94),Y=function(){var e=Object(w.b)(),t=Object(w.c)((function(e){return e.user}));return r.a.createElement("div",{className:"menuItem",id:"loggedInText"},t.name," logged-in ",r.a.createElement(m.a,{variant:"outline-primary",size:"sm",onClick:function(){window.localStorage.clear(),e(N(null)),e(_("Logged out successfuly")),setTimeout((function(){e({type:"REMOVE_MESAGE",message:null})}),5e3)},id:"logOutButton"},"log out"))},Z=function(){var e=Object(w.b)(),t=Object(w.c)((function(e){return e.user}));Object(a.useEffect)((function(){var t=window.localStorage.getItem("loggedBlogappUser");if(t){var n=JSON.parse(t);e(N(n)),O.setToken(n.token)}}),[e]);var n={padding:5};return r.a.createElement(D.a,null,r.a.createElement("div",{className:"container"},r.a.createElement(Q.a,{collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark"},r.a.createElement(Q.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),r.a.createElement(Q.a.Collapse,{id:"responsive-navbar-nav"},r.a.createElement(X.a,{className:"mr-auto"},r.a.createElement(X.a.Link,{href:"#",as:"span"},r.a.createElement(D.b,{style:n,to:"/"},"home")),r.a.createElement(X.a.Link,{href:"#",as:"span"},r.a.createElement(D.b,{style:n,to:"/users"},"users")),r.a.createElement(X.a.Item,{id:"loggedInIndicator"},null===t?null:r.a.createElement(Y,null))))),r.a.createElement(H,null),r.a.createElement(q.c,null,r.a.createElement(q.a,{path:"/users/:id"},r.a.createElement(F,null)),r.a.createElement(q.a,{path:"/users"},r.a.createElement(z,null)),r.a.createElement(q.a,{path:"/blogs/:id"},r.a.createElement(K,null)),r.a.createElement(q.a,{path:"/"},r.a.createElement(J,null)))))},$=(n(87),n(22)),ee=n(54),te=n(55),ne=Object($.combineReducers)({blogs:x,credentials:C,user:I,message:A,users:W}),ae=Object($.createStore)(ne,Object(te.composeWithDevTools)(Object($.applyMiddleware)(ee.a)));c.a.render(r.a.createElement(w.a,{store:ae},r.a.createElement(Z,null)),document.getElementById("root"))}},[[58,1,2]]]);
//# sourceMappingURL=main.1bd92a22.chunk.js.map